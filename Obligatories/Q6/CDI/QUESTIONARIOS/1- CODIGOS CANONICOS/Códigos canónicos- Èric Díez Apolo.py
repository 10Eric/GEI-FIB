def codificar_mensaje(mensaje, codigo_canonico):
    mensaje_codificado = ""
    for caracter in mensaje:
        mensaje_codificado += codigo_canonico[caracter]

    return mensaje_codificado

def decodificar_mensaje(mensaje_codificado, codigo_canonico):
    mensaje_decodificado = ""
    buffer = ""

    for bit in mensaje_codificado:
        buffer += bit
        if buffer in codigo_canonico:
            mensaje_decodificado += codigo_canonico[buffer]
            buffer = ""

    return mensaje_decodificado

def generar_codigo_canonico(codificacion,verdadero):
    codificacion_ordenada = sorted(codificacion, key=lambda x: (x[1], x[0]))
    codigo_canonico = {}
    codigo_binario = 0
    longitud_anterior = 0

    for caracter, longitud in codificacion_ordenada:
        if longitud != longitud_anterior:
            codigo_binario <<= (longitud - longitud_anterior)
        if (verdadero): codigo_canonico[f'{codigo_binario:0{longitud}b}'] = caracter
        else: codigo_canonico[caracter] = f'{codigo_binario:0{longitud}b}'
        codigo_binario += 1
        longitud_anterior = longitud

    return codigo_canonico


#PREGUNTA 1 !!!!!

# Mensaje a codificar
mensaje = "The Island of Doctor Moreau, by H. G. Wells [...] Incontinently those at the opening of the hut vanished; my Ape-man rushed out; the thing that had sat in the dark followed him (I only observed that it was big and clumsy, and covered with silvery hair), and I was left alone. Then before I reached the aperture I heard the yelp of a staghound. In another moment I was standing outside the hovel, my chair-rail in my hand, every muscle of me quivering. Before me were the clumsy backs of perhaps a score of these Beast People, their misshapen heads half hidden by their shoulder-blades. They were gesticulating excitedly."
# Codificación proporcionada
codificacion = [(' ', 3), ('(', 9), (')', 9), (',', 7), ('-', 8), ('.', 6), (';', 8), ('A', 9), ('B', 9), ('D', 9), ('G', 9), ('H', 9), ('I', 6), ('M', 9), ('P', 9), ('T', 8), ('W', 9), ('[', 9), (']', 10), ('a', 4), ('b', 6), ('c', 6), ('d', 5), ('e', 3), ('f', 6), ('g', 6), ('h', 4), ('i', 5), ('k', 9), ('l', 5), ('m', 6), ('n', 4), ('o', 4), ('p', 6), ('q', 10), ('r', 5), ('s', 4), ('t', 4), ('u', 6), ('v', 6), ('w', 6), ('x', 9), ('y', 5)]
codigo_canonico = generar_codigo_canonico(codificacion,False)
# Codificar el mensaje
mensaje_codificado = codificar_mensaje(mensaje, codigo_canonico)
print("Mensaje codificado:", mensaje_codificado + '\n')


#PREGUNTA 2 !!!!!

# Mensaje a codificar
mensaje = "The Island of Doctor Moreau, by H. G. Wells [...] I taught him the rudiments of English; gave him ideas of counting; even made the thing read the alphabet. But at that he was slow, though I've met with idiots slower. He began with a clean sheet, mentally; had no memories left in his mind of what he had been. When his scars were quite healed, and he was no longer anything but painful and stiff, and able to converse a little, I took him yonder and introduced him to the Kanakas as an interesting stowaway. They were horribly afraid of him at first, somehow,--which offended me rather, for I was conceited about him; but his ways seemed so mild, and he was so abject, that after a time they received him and took his education in hand. He was quick to learn, very imitative and adaptive, and built himself a hovel rather better, it seemed to me, than their own shanties. There was one among the boys a bit of a missionary, and he taught the thing to read, or at least to pick out letters, and gave him some rudimentary ideas of morality; but it seems the beast's habits were not all that is desirable."
# Codificación proporcionada
codificacion = [(' ', 3), ("'", 9), (',', 6), ('-', 9), ('.', 6), (';', 8), ('B', 10), ('D', 10), ('E', 10), ('G', 10), ('H', 8), ('I', 8), ('K', 10), ('M', 10), ('T', 8), ('W', 9), ('[', 11), (']', 11), ('a', 4), ('b', 6), ('c', 6), ('d', 5), ('e', 3), ('f', 6), ('g', 6), ('h', 4), ('i', 4), ('j', 10), ('k', 8), ('l', 5), ('m', 5), ('n', 4), ('o', 4), ('p', 8), ('q', 9), ('r', 5), ('s', 4), ('t', 4), ('u', 6), ('v', 7), ('w', 6), ('y', 6)]
codigo_canonico = generar_codigo_canonico(codificacion,False)
# Codificar el mensaje
mensaje_codificado = codificar_mensaje(mensaje, codigo_canonico)
print("Mensaje codificado:", mensaje_codificado + '\n')


#PREGUNTA 3 !!!!!

# Mensaje codificado para decodificar
mensaje_codificado = "111101100110010100110101110011011101000111101000010001101100011111010010001110101100110001100000111101001000110000101010011100011100100011101001110111001110011110100001111001111010000111111010010110111101111100100111111101110100110100110100111111110001111000110010010010110010010011110010001001011010001110001010101100011010100111011001001100100110110010010110011110010001000111101000001101000110001100010110111010010111111011100110110010010011011010101111000010110100111001000110101001010101001001011001011100001011010000100110001010101011001011001011100000010010111101110011011111101110011001100111000010101111010110010110111001000010001111010000111010001011010101000111001100011100001110111101100111101010001001010101001011001110010011000111011001001100010100110010010010110010100101111011010101011010011101000011010100100101101000111000101010110100100110101000110010101001100010100000100001111100010001011011101010101001110101010010111101111011001111010100110111010111010000111111011110100001111011011100111111001000111110011111111000111111100110101111101011111001100111110110111110101001111011011100111111001000111101001111000111110101110100001111000111111100100110101001010011000010111101100001110101010011000001001011001010001101000111000110010101001101010011001010011101100010010110010010010010010110010100101111011010101011010010011001011010000111010100110110110001000110111001001011001010010001111011101010111001010010001000110000010001101100011011111101110011000100010001101111111100100001000111101000010010110010101110011010100011001010100110001010000111010110001101111011001111010100110110110001000110111001000111000100100100011011000100101100101001010001001100011111111101110101110011100100010010010010010110010100110011011010100010100100011011000100101100100100100100011000010001111010101010010001110100101111000011110101001000110110001011110110101010110100111100100010010110010100111110001000101101110101010100100011011000111101001000011110011010110001101110101110001110111001100101101000111000100110110011110101111001000111110111110000101011110100101101110101111111111111100000011010100111010110000111100110110011111100001011010000110001110000111011110110011110101110100001111101111100001011100101010111100110111111011100110101000110010101001100010100000110101101101110001001010101001011001111101000011010100110000101111101111011110110010110100001110100111011100010000110110010101011110100101110101001110011111000101111011110001111000000010001111010000101100111000100011110001001011001011100000110111100011011101010111100100011001001010000110011001010010101101010101110000101101000011100011110111001001100000011010110110111110100"
codificacion = [(' ', 2), ('!', 8), (',', 7), ('.', 6), (';', 9), ('A', 8), ('C', 9), ('D', 9), ('E', 8), ('F', 9), ('G', 8), ('H', 7), ('I', 6), ('M', 8), ('N', 8), ('O', 9), ('P', 9), ('R', 9), ('S', 9), ('T', 8), ('W', 9), ('X', 9), ('Y', 9), ('[', 9), (']', 9), ('a', 4), ('b', 7), ('c', 7), ('d', 5), ('e', 4), ('f', 6), ('g', 5), ('h', 4), ('i', 5), ('k', 9), ('l', 5), ('m', 6), ('n', 4), ('o', 4), ('p', 8), ('r', 5), ('s', 5), ('t', 4), ('u', 6), ('v', 8), ('w', 7), ('y', 7)]
codigo_canonico = generar_codigo_canonico(codificacion,True)
# Decodificar el mensaje
mensaje_decodificado = decodificar_mensaje(mensaje_codificado, codigo_canonico)
print("Mensaje decodificado:", mensaje_decodificado + '\n')


#PREGUNTA 4 !!!!!

# Mensaje codificado para decodificar
mensaje_codificado = "11111110101010010001101001011110100010001101001000001111101110001111110100111110110100001111011000011110000111101100010100110001100100001101011110100001111100011001100011111101111001100011111001001101001010010111000111111111011001111001111001111111111110001101000001110010010110100000001110110000101110101011111000100010011011011100011001000011010000010111110110010010110110110001101001110100001011000110101001101011101010011011000011100101010100100011001011101101110110100001010100100000011110000111101100010100110000000100011010010000111100001110110100011100001111010100110110111010000110110011111000101001001000011010100100011111010100111010010100001100101100100001000010101001000000100001010011110100001110010011011000100001100111100000010000111000110101001000110111001010010110001100101111011000010000101010010000001110010100101110001000010100100011010111000101101001000101100000111110111000111001010101001000000110100000111100111000100000010011011010000111000100001010010000101001010010010101110000111110111000100001010010001111110010010100101111000000111111100001011111110011010000111001100011010000010111010011100100010000101001000111000101100010010110111011000111101000110010000101010100011000010011011000010000101001000100100100101101111101000010110010011100010111110010000111001010101110000101010010010000101010011000000101010010000111011000010000101001000001111101000101101001101101110000000111110111000101011110100000100101101011010011111101001001010011001000011011001111010100100001111100010000001101111011001111010100001001010101110110111000000100001010010001000101100010011011111001000001000110100100000111100001010011011010111000110111011110100101000111111001001100100000101100111010111001000010000111000010100101001011000010101001000110101001100010000011011011001100011111100010000001010001001011110000001101110111101100001110010100011010000000111110111000110101101100010100100001010001101000001111001010011000101110011001011001100011101111001110111100000101100001000011100010101001000110111011110110000010000010101011110101001011010001100100001011101001001110010000100001010010001011110000010100100101110100001111010011110011110110001000011111011100011110000111101100010100110001111011100001000110100100001000010100101100001011101001110100001110010101010010000001110100111110000001110011001110100101001100110001111100100110100101001111101110001011101001001110010000110100110011000111110000010001101100111110001110000101001100101100100001000010101111100011100001011000110010000100001010010110000101110101011111000100000110010111101100001110111010010001001101101100100001111111001011000101101001010011110110111110101111101100001101010100100100001110111010010001001101101100100001011111011001010111011110100110101011111101000011101110100100010011011011110111000110101110001000000100010110111010000010001101001000011000011010010001101101011110000100011010010110011000111110001001100001100111011000010111110000110100000001010111101011001101100011011111110111000101111100001101000000010001101001110101010010100100110100000111111110110001001100001100111101110000101010011010100110101110001011111101101110110111101010011111101010011101110011101101000001100101100110001111110000000101110001010101000110100111011110011011011100000011110011011001111101100011011110111110011"
codificacion = [(' ', 3), ('!', 9), (',', 6), ('-', 7), ('.', 6), (':', 8), (';', 8), ('?', 9), ('A', 9), ('B', 9), ('D', 9), ('G', 9), ('H', 8), ('I', 6), ('L', 7), ('M', 7), ('P', 9), ('T', 9), ('W', 8), ('[', 10), (']', 10), ('a', 4), ('b', 6), ('c', 6), ('d', 5), ('e', 3), ('f', 6), ('g', 6), ('h', 4), ('i', 5), ('k', 8), ('l', 5), ('m', 5), ('n', 4), ('o', 4), ('p', 7), ('q', 9), ('r', 5), ('s', 5), ('t', 4), ('u', 5), ('v', 7), ('w', 6), ('y', 6)]
codigo_canonico = generar_codigo_canonico(codificacion,True)
# Decodificar el mensaje
mensaje_decodificado = decodificar_mensaje(mensaje_codificado, codigo_canonico)
print("Mensaje decodificado:", mensaje_decodificado + '\n')
